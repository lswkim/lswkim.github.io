---
title: "[gRPC ê¸°ë°˜ê¸°ìˆ  3] Protocol Buffers (Protobuf)"
date: 2025-12-28 18:00:00 +0900
categories: [Tech, gRPC]
tags: [protobuf, protocol-buffers, serialization, grpc]
mermaid: true
---

> **ğŸ“š gRPC ì‹œë¦¬ì¦ˆ - Part 1. ê¸°ë°˜ ê¸°ìˆ **
>
> 1. [RPC(Remote Procedure Call) ê°œë…](/posts/rpc-concept/)
> 2. [IDLê³¼ ì§ë ¬í™”/ì—­ì§ë ¬í™”](/posts/idl-serialization/)
> 3. Protocol Buffers (Protobuf) â† í˜„ì¬ ê¸€
> 4. [HTTP/2 í”„ë¡œí† ì½œ](/posts/http2/)

---

## ì™œ Protobufë¥¼ ì•Œì•„ì•¼ í•˜ëŠ”ê°€?

ProtobufëŠ” gRPCì˜ **ê¸°ë³¸ ì–¸ì–´**ì´ë‹¤.

- gRPC ì„œë¹„ìŠ¤ë¥¼ ì •ì˜í•˜ë ¤ë©´ â†’ .proto íŒŒì¼ ì‘ì„±
- ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ìœ¼ë ¤ë©´ â†’ Protobuf ë©”ì‹œì§€ ì •ì˜
- í´ë¼ì´ì–¸íŠ¸/ì„œë²„ ì½”ë“œ ìƒì„±í•˜ë ¤ë©´ â†’ protoc ì»´íŒŒì¼ëŸ¬ ì‚¬ìš©

Protobufë¥¼ ëª¨ë¥´ë©´ gRPCë¥¼ ì“¸ ìˆ˜ ì—†ë‹¤.

---

## Protobufë€?

### í•œ ì¤„ ì •ì˜

Protocol BuffersëŠ” Googleì´ ê°œë°œí•œ **ì–¸ì–´ ì¤‘ë¦½ì , í”Œë«í¼ ì¤‘ë¦½ì ì¸ ì§ë ¬í™” í¬ë§·**ì´ë‹¤.

### í•µì‹¬ íŠ¹ì§•

| íŠ¹ì§• | ì„¤ëª… |
| --- | --- |
| **ë°”ì´ë„ˆë¦¬ í¬ë§·** | JSONë³´ë‹¤ ì‘ê³  ë¹ ë¦„ |
| **ìŠ¤í‚¤ë§ˆ ê¸°ë°˜** | .proto íŒŒì¼ë¡œ êµ¬ì¡° ì •ì˜ |
| **ì½”ë“œ ìë™ ìƒì„±** | Python, Go, Java ë“± ì—¬ëŸ¬ ì–¸ì–´ ì§€ì› |
| **í•˜ìœ„ í˜¸í™˜ì„±** | í•„ë“œ ì¶”ê°€/ì‚­ì œì— ìœ ì—°í•¨ |
| **íƒ€ì… ì•ˆì „** | ì»´íŒŒì¼ íƒ€ì„ì— íƒ€ì… ì²´í¬ |

---

## .proto íŒŒì¼ ê¸°ë³¸ êµ¬ì¡°

### ì „ì²´ êµ¬ì¡°

```protobuf
// user.proto

// 1. ë¬¸ë²• ë²„ì „ ì„ ì–¸ (í•„ìˆ˜)
syntax = "proto3";

// 2. íŒ¨í‚¤ì§€ ì„ ì–¸ (ë„¤ì„ìŠ¤í˜ì´ìŠ¤)
package user.v1;

// 3. ì˜µì…˜ ì„¤ì •
option go_package = "github.com/myproject/user/v1";
option java_package = "com.myproject.user.v1";

// 4. import (ë‹¤ë¥¸ .proto íŒŒì¼ ì°¸ì¡°)
import "google/protobuf/timestamp.proto";

// 5. ë©”ì‹œì§€ ì •ì˜ (ë°ì´í„° êµ¬ì¡°)
message User {
    int32 user_id = 1;
    string name = 2;
    string email = 3;
}

// 6. ì„œë¹„ìŠ¤ ì •ì˜ (gRPCìš©)
service UserService {
    rpc GetUser(GetUserRequest) returns (User);
    rpc CreateUser(CreateUserRequest) returns (User);
}
```

---

## ë©”ì‹œì§€ ì •ì˜

### ê¸°ë³¸ ë¬¸ë²•

```protobuf
message User {
    int32 user_id = 1;      // íƒ€ì… í•„ë“œëª… = í•„ë“œë²ˆí˜¸;
    string name = 2;
    string email = 3;
    bool is_active = 4;
}
```

### ë©”ì‹œì§€ êµ¬ì„± ìš”ì†Œ

```mermaid
flowchart LR
    A["int32 user_id = 1;"]
    B["íƒ€ì…<br/>(int32, string, bool ë“±)"]
    C["í•„ë“œ ì´ë¦„<br/>(ì½”ë“œì—ì„œ ì‚¬ìš©)"]
    D["í•„ë“œ ë²ˆí˜¸<br/>(ë°”ì´ë„ˆë¦¬ ì¸ì½”ë”©ì— ì‚¬ìš©)"]

    A --> B
    A --> C
    A --> D
```

---

## ìŠ¤ì¹¼ë¼ íƒ€ì…

### íƒ€ì… ëª©ë¡

| .proto íƒ€ì… | Python | Go | Java | ì„¤ëª… |
| --- | --- | --- | --- | --- |
| `double` | float | float64 | double | 64ë¹„íŠ¸ ë¶€ë™ì†Œìˆ˜ì  |
| `float` | float | float32 | float | 32ë¹„íŠ¸ ë¶€ë™ì†Œìˆ˜ì  |
| `int32` | int | int32 | int | 32ë¹„íŠ¸ ì •ìˆ˜ (ìŒìˆ˜ ë¹„íš¨ìœ¨) |
| `int64` | int | int64 | long | 64ë¹„íŠ¸ ì •ìˆ˜ |
| `uint32` | int | uint32 | int | ë¶€í˜¸ ì—†ëŠ” 32ë¹„íŠ¸ |
| `uint64` | int | uint64 | long | ë¶€í˜¸ ì—†ëŠ” 64ë¹„íŠ¸ |
| `sint32` | int | int32 | int | ìŒìˆ˜ì— íš¨ìœ¨ì ì¸ 32ë¹„íŠ¸ |
| `sint64` | int | int64 | long | ìŒìˆ˜ì— íš¨ìœ¨ì ì¸ 64ë¹„íŠ¸ |
| `bool` | bool | bool | boolean | ë¶ˆë¦¬ì–¸ |
| `string` | str | string | String | UTF-8 ë¬¸ìì—´ |
| `bytes` | bytes | []byte | ByteString | ë°”ì´íŠ¸ ë°°ì—´ |

### ì •ìˆ˜ íƒ€ì… ì„ íƒ ê°€ì´ë“œ

| ìƒí™© | ê¶Œì¥ íƒ€ì… |
| --- | --- |
| ì–‘ìˆ˜ë§Œ ì‚¬ìš© (ID, ì¹´ìš´íŠ¸ ë“±) | uint32, uint64 |
| ì–‘ìˆ˜ê°€ ëŒ€ë¶€ë¶„, ìŒìˆ˜ ê±°ì˜ ì—†ìŒ | int32, int64 |
| ìŒìˆ˜ê°€ ìì£¼ ì‚¬ìš©ë¨ (ì˜¨ë„, ì¢Œí‘œ ë“±) | sint32, sint64 |
| ê³ ì • í¬ê¸°ê°€ í•„ìš”í•¨ (í•´ì‹œ ë“±) | fixed32, fixed64 |

---

## í•„ë“œ ë²ˆí˜¸ì˜ ì¤‘ìš”ì„±

### í•„ë“œ ë²ˆí˜¸ë€?

```protobuf
message User {
    int32 user_id = 1;   // â† 1, 2, 3ì´ í•„ë“œ ë²ˆí˜¸
    string name = 2;
    string email = 3;
}
```

### ì™œ í•„ë“œ ë²ˆí˜¸ë¥¼ ì“°ëŠ”ê°€?

```mermaid
flowchart TB
    subgraph JSON["JSON"]
        J1["{'user_id': 123, 'name': 'í™ê¸¸ë™'}"]
        J2["í•„ë“œëª… ì „ì†¡ (8+6 bytes)"]
        J3["â†’ ì˜¤ë²„í—¤ë“œ í¼"]
    end

    subgraph Protobuf["Protobuf"]
        P1["[08 7B] [12 09 ...]"]
        P2["í•„ë“œë²ˆí˜¸ë§Œ ì „ì†¡ (1~2 bytes)"]
        P3["â†’ íš¨ìœ¨ì "]
    end
```

### í•„ë“œ ë²ˆí˜¸ ê·œì¹™

| ë²”ìœ„ | ì¸ì½”ë”© í¬ê¸° | ê¶Œì¥ ìš©ë„ |
| --- | --- | --- |
| **1 ~ 15** | 1 byte | ìì£¼ ì‚¬ìš©í•˜ëŠ” í•„ë“œì— í• ë‹¹ |
| **16 ~ 2047** | 2 bytes | ì¼ë°˜ í•„ë“œ |
| **2048 ~ 524287** | 3 bytes | ê±°ì˜ ì‚¬ìš© ì•ˆ í•¨ |
| **19000 ~ 19999** | - | ì˜ˆì•½ë¨, ì‚¬ìš© ê¸ˆì§€ |

### ì ˆëŒ€ í•˜ë©´ ì•ˆ ë˜ëŠ” ê²ƒ

**[1] í•„ë“œ ë²ˆí˜¸ ë³€ê²½ ê¸ˆì§€**

```protobuf
// v1
message User {
    int32 user_id = 1;
    string name = 2;
}

// v2 - ì˜ëª»ëœ ë³€ê²½!
message User {
    int32 user_id = 2;  // âŒ 1ì—ì„œ 2ë¡œ ë³€ê²½
    string name = 1;    // âŒ 2ì—ì„œ 1ë¡œ ë³€ê²½
}
// â†’ ê¸°ì¡´ ë°ì´í„° ì½ê¸° ë¶ˆê°€!
```

**[2] ì‚­ì œëœ í•„ë“œ ë²ˆí˜¸ ì¬ì‚¬ìš© ê¸ˆì§€**

```protobuf
// v2 - ì˜ëª»ëœ ë°©ë²•
message User {
    int32 user_id = 1;
    string name = 2;
    string email = 3;     // âŒ ì‚­ì œëœ 3ë²ˆ ì¬ì‚¬ìš©
}

// v2 - ì˜¬ë°”ë¥¸ ë°©ë²•
message User {
    int32 user_id = 1;
    string name = 2;
    reserved 3;           // âœ… 3ë²ˆì€ ì˜ˆì•½
    string email = 4;     // âœ… ìƒˆ ë²ˆí˜¸ ì‚¬ìš©
}
```

---

## ë³µí•© íƒ€ì…

### ì¤‘ì²© ë©”ì‹œì§€ (Nested Message)

```protobuf
message User {
    int32 user_id = 1;
    string name = 2;

    // ì¤‘ì²© ë©”ì‹œì§€ ì •ì˜
    message Address {
        string city = 1;
        string street = 2;
        string zip_code = 3;
    }

    Address address = 3;  // ì¤‘ì²© ë©”ì‹œì§€ ì‚¬ìš©
}
```

### ë³„ë„ ë©”ì‹œì§€ë¡œ ë¶„ë¦¬

```protobuf
message Address {
    string city = 1;
    string street = 2;
    string zip_code = 3;
}

message User {
    int32 user_id = 1;
    string name = 2;
    Address address = 3;  // ë‹¤ë¥¸ ë©”ì‹œì§€ ì°¸ì¡°
}
```

### ë°°ì—´/ë¦¬ìŠ¤íŠ¸ (repeated)

```protobuf
message User {
    int32 user_id = 1;
    string name = 2;

    repeated string tags = 3;           // ë¬¸ìì—´ ë°°ì—´
    repeated Address addresses = 4;     // ë©”ì‹œì§€ ë°°ì—´
}
```

```python
# Pythonì—ì„œ ì‚¬ìš©
user = User()
user.user_id = 1
user.name = "í™ê¸¸ë™"
user.tags.append("developer")
user.tags.append("python")
user.tags.extend(["grpc", "mlops"])

print(user.tags)  # ['developer', 'python', 'grpc', 'mlops']
```

### Map íƒ€ì…

```protobuf
message User {
    int32 user_id = 1;
    string name = 2;

    map<string, string> metadata = 3;   // key-value ë§µ
    map<string, int32> scores = 4;      // ì ìˆ˜ ë§µ
}
```

```python
# Pythonì—ì„œ ì‚¬ìš©
user = User()
user.metadata["department"] = "AIíŒ€"
user.metadata["level"] = "senior"

user.scores["math"] = 95
user.scores["english"] = 88
```

---

## Enum (ì—´ê±°í˜•)

```protobuf
// ìƒíƒœ ì •ì˜
enum UserStatus {
    USER_STATUS_UNSPECIFIED = 0;  // ê¸°ë³¸ê°’ (proto3 í•„ìˆ˜)
    USER_STATUS_ACTIVE = 1;
    USER_STATUS_INACTIVE = 2;
    USER_STATUS_SUSPENDED = 3;
}

message User {
    int32 user_id = 1;
    string name = 2;
    UserStatus status = 3;
}
```

### Enum ê·œì¹™

| ê·œì¹™ | ì„¤ëª… |
| --- | --- |
| **ì²« ë²ˆì§¸ ê°’ì€ 0** | proto3ì—ì„œ ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš©ë¨ |
| **ì ‘ë‘ì‚¬ ê¶Œì¥** | USER_STATUS_ACTIVE (O), ACTIVE (X) - ë‹¤ë¥¸ enumê³¼ ì¶©ëŒ ê°€ëŠ¥ |
| **UNSPECIFIED í¬í•¨** | ê°’ì´ ì„¤ì •ë˜ì§€ ì•Šì€ ìƒíƒœë¥¼ ëª…ì‹œì ìœ¼ë¡œ í‘œí˜„ |

---

## ì„œë¹„ìŠ¤ ì •ì˜ (gRPCìš©)

### ê¸°ë³¸ ì„œë¹„ìŠ¤ ì •ì˜

```protobuf
service UserService {
    // Unary RPC (ë‹¨ì¼ ìš”ì²­ - ë‹¨ì¼ ì‘ë‹µ)
    rpc GetUser(GetUserRequest) returns (GetUserResponse);

    // Server Streaming (ë‹¨ì¼ ìš”ì²­ - ìŠ¤íŠ¸ë¦¼ ì‘ë‹µ)
    rpc ListUsers(ListUsersRequest) returns (stream User);

    // Client Streaming (ìŠ¤íŠ¸ë¦¼ ìš”ì²­ - ë‹¨ì¼ ì‘ë‹µ)
    rpc UploadUsers(stream User) returns (UploadUsersResponse);

    // Bidirectional Streaming (ì–‘ë°©í–¥ ìŠ¤íŠ¸ë¦¼)
    rpc Chat(stream ChatMessage) returns (stream ChatMessage);
}
```

### ìš”ì²­/ì‘ë‹µ ë©”ì‹œì§€ íŒ¨í„´

```protobuf
// ìš”ì²­ ë©”ì‹œì§€ - ì ‘ë¯¸ì‚¬ Request
message GetUserRequest {
    int32 user_id = 1;
}

message ListUsersRequest {
    int32 page_size = 1;
    string page_token = 2;
}

message CreateUserRequest {
    string name = 1;
    string email = 2;
}

// ì‘ë‹µ ë©”ì‹œì§€ - ì ‘ë¯¸ì‚¬ Response
message GetUserResponse {
    User user = 1;
}

message ListUsersResponse {
    repeated User users = 1;
    string next_page_token = 2;
}

message CreateUserResponse {
    User user = 1;
}
```

---

## ì½”ë“œ ìƒì„±

### íë¦„

```mermaid
flowchart TD
    A[user.proto] --> B[protoc ì»´íŒŒì¼ëŸ¬]

    subgraph Generated["ìƒì„±ëœ ì½”ë“œ"]
        C["Python<br/>user_pb2.py<br/>user_pb2_grpc.py"]
        D["Go<br/>user.pb.go<br/>user_grpc.pb.go"]
        E["Java<br/>User.java<br/>UserServiceGrpc.java"]
    end

    B --> C
    B --> D
    B --> E
```

### Python ì½”ë“œ ìƒì„±

```bash
# 1. íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install grpcio grpcio-tools

# 2. ì½”ë“œ ìƒì„± ëª…ë ¹
python -m grpc_tools.protoc \
    -I./protos \
    --python_out=./generated \
    --grpc_python_out=./generated \
    ./protos/user.proto
```

### ìƒì„±ëœ ì½”ë“œ ì‚¬ìš©

```python
from generated import user_pb2
from generated import user_pb2_grpc

# ë©”ì‹œì§€ ìƒì„±
user = user_pb2.User()
user.user_id = 123
user.name = "í™ê¸¸ë™"
user.email = "hong@example.com"

# ë˜ëŠ” ìƒì„±ìë¡œ
user = user_pb2.User(
    user_id=123,
    name="í™ê¸¸ë™",
    email="hong@example.com"
)

# ì§ë ¬í™” (ë°”ì´íŠ¸ë¡œ ë³€í™˜)
serialized = user.SerializeToString()
print(f"í¬ê¸°: {len(serialized)} bytes")

# ì—­ì§ë ¬í™” (ë°”ì´íŠ¸ì—ì„œ ë³µì›)
new_user = user_pb2.User()
new_user.ParseFromString(serialized)
print(new_user.name)  # "í™ê¸¸ë™"
```

---

## ìŠ¤í‚¤ë§ˆ ì§„í™” (Schema Evolution)

### ì™œ ì¤‘ìš”í•œê°€?

```mermaid
flowchart TB
    subgraph Problem["ì‹¤ì œ ìš´ì˜ ìƒí™©"]
        A["Day 1: v1 ì„œë²„, v1 í´ë¼ì´ì–¸íŠ¸ ë°°í¬"]
        B["Day 30: ìš”êµ¬ì‚¬í•­ ë³€ê²½!<br/>Userì— phone í•„ë“œ ì¶”ê°€ í•„ìš”"]
        C["ë¬¸ì œ: ì„œë²„ëŠ” v2, í´ë¼ì´ì–¸íŠ¸ëŠ” ì•„ì§ v1<br/>ëª¨ë°”ì¼ ì•±ì€ ì—…ë°ì´íŠ¸ì— ì‹œê°„ ê±¸ë¦¼"]
        D["â†’ v1 í´ë¼ì´ì–¸íŠ¸ì™€ v2 ì„œë²„ê°€ í†µì‹  ê°€ëŠ¥í•´ì•¼ í•¨!"]
    end

    A --> B --> C --> D
```

### ì•ˆì „í•œ ë³€ê²½ (í•˜ìœ„ í˜¸í™˜)

```protobuf
// v1
message User {
    int32 user_id = 1;
    string name = 2;
}

// v2 - í•„ë“œ ì¶”ê°€ (ì•ˆì „ âœ…)
message User {
    int32 user_id = 1;
    string name = 2;
    string email = 3;      // ìƒˆ í•„ë“œ ì¶”ê°€
    string phone = 4;      // ìƒˆ í•„ë“œ ì¶”ê°€
}
```

### í•„ë“œ ì¶”ê°€ ì‹œ ë™ì‘

| ì‹œë‚˜ë¦¬ì˜¤ | ë™ì‘ |
| --- | --- |
| v2 ì„œë²„ â†’ v1 í´ë¼ì´ì–¸íŠ¸ | email, phone í¬í•¨ ì „ì†¡ë¨, v1ì€ ëª¨ë¥´ëŠ” í•„ë“œ ë¬´ì‹œ, ì •ìƒ ë™ì‘ âœ… |
| v1 í´ë¼ì´ì–¸íŠ¸ â†’ v2 ì„œë²„ | email, phone ì—†ì´ ì „ì†¡ë¨, v2ëŠ” ê¸°ë³¸ê°’ìœ¼ë¡œ ì²˜ë¦¬, ì •ìƒ ë™ì‘ âœ… |

### ë³€ê²½ ìœ í˜•ë³„ í˜¸í™˜ì„±

| ë³€ê²½ ìœ í˜• | í•˜ìœ„ í˜¸í™˜ | ì„¤ëª… |
| --- | --- | --- |
| ìƒˆ í•„ë“œ ì¶”ê°€ | âœ… | ê¸°ì¡´ í´ë¼ì´ì–¸íŠ¸ëŠ” ìƒˆ í•„ë“œ ë¬´ì‹œ |
| í•„ë“œ ì‚­ì œ | âœ… | ë‹¨, ë²ˆí˜¸ ì¬ì‚¬ìš© ê¸ˆì§€ (reserved ì‚¬ìš©) |
| í•„ë“œëª… ë³€ê²½ | âœ… | ë°”ì´ë„ˆë¦¬ëŠ” ë²ˆí˜¸ë¡œ ì‹ë³„ |
| í•„ë“œ ë²ˆí˜¸ ë³€ê²½ | âŒ | ê¸°ì¡´ ë°ì´í„° ì½ê¸° ë¶ˆê°€ |
| í•„ë“œ íƒ€ì… ë³€ê²½ | âŒ | íŒŒì‹± ì˜¤ë¥˜ ë°œìƒ |
| required â†’ optional | âœ… | proto3ëŠ” ê¸°ë³¸ì´ optional |

### reserved í‚¤ì›Œë“œ

```protobuf
message User {
    int32 user_id = 1;
    string name = 2;

    // ì‚­ì œëœ í•„ë“œ ë²ˆí˜¸ì™€ ì´ë¦„ì„ ì˜ˆì•½
    reserved 3, 4, 10 to 15;
    reserved "nickname", "avatar";

    string email = 5;  // ìƒˆ í•„ë“œëŠ” ë‹¤ë¥¸ ë²ˆí˜¸ ì‚¬ìš©
}
```

### reservedë¥¼ ì“°ëŠ” ì´ìœ 

| ì´ìœ  | ì„¤ëª… |
| --- | --- |
| **ì‹¤ìˆ˜ ë°©ì§€** | ë‹¤ë¥¸ ê°œë°œìê°€ ì‚­ì œëœ ë²ˆí˜¸ë¥¼ ì¬ì‚¬ìš©í•˜ë©´ ì»´íŒŒì¼ ì—ëŸ¬ |
| **ë¬¸ì„œí™”** | ì–´ë–¤ í•„ë“œê°€ ì‚­ì œë˜ì—ˆëŠ”ì§€ ê¸°ë¡ìœ¼ë¡œ ë‚¨ìŒ |
| **í˜¸í™˜ì„± ë³´ì¥** | ì´ì „ ë²„ì „ ë°ì´í„°ì™€ ì¶©ëŒ ë°©ì§€ |

---

## ì‹¤ì „ ì˜ˆì‹œ: ML ì¶”ë¡  ë©”ì‹œì§€

### Triton ìŠ¤íƒ€ì¼ ì¶”ë¡  ìš”ì²­

```protobuf
syntax = "proto3";

package inference.v1;

// ì¶”ë¡  ìš”ì²­
message InferRequest {
    string model_name = 1;
    string model_version = 2;

    repeated InferInputTensor inputs = 3;
    repeated InferRequestedOutputTensor outputs = 4;
}

// ì…ë ¥ í…ì„œ
message InferInputTensor {
    string name = 1;                    // "input_ids", "attention_mask" ë“±
    string datatype = 2;                // "INT64", "FP32" ë“±
    repeated int64 shape = 3;           // [1, 512]

    // ì‹¤ì œ ë°ì´í„° (íƒ€ì…ë³„ë¡œ í•˜ë‚˜ë§Œ ì‚¬ìš©)
    bytes raw_contents = 4;             // ë°”ì´ë„ˆë¦¬ ë°ì´í„°
    repeated int64 int64_contents = 5;  // INT64 ë°°ì—´
    repeated float fp32_contents = 6;   // FP32 ë°°ì—´
}

// ìš”ì²­í•  ì¶œë ¥
message InferRequestedOutputTensor {
    string name = 1;
}

// ì¶”ë¡  ì‘ë‹µ
message InferResponse {
    string model_name = 1;
    string model_version = 2;

    repeated InferOutputTensor outputs = 3;
}

// ì¶œë ¥ í…ì„œ
message InferOutputTensor {
    string name = 1;
    string datatype = 2;
    repeated int64 shape = 3;

    bytes raw_contents = 4;
    repeated float fp32_contents = 5;
}

// ì„œë¹„ìŠ¤ ì •ì˜
service InferenceService {
    rpc Infer(InferRequest) returns (InferResponse);
    rpc StreamInfer(stream InferRequest) returns (stream InferResponse);
}
```

---

## í•µì‹¬ ì •ë¦¬

### .proto íŒŒì¼ êµ¬ì¡°

| ìš”ì†Œ | ì„¤ëª… |
| --- | --- |
| syntax | ë²„ì „ ì„ ì–¸ (proto3) |
| package | ë„¤ì„ìŠ¤í˜ì´ìŠ¤ |
| import | ë‹¤ë¥¸ proto íŒŒì¼ ì°¸ì¡° |
| message | ë°ì´í„° êµ¬ì¡° ì •ì˜ |
| service | RPC ë©”ì„œë“œ ì •ì˜ |
| enum | ì—´ê±°í˜• ì •ì˜ |

### í•„ë“œ ë²ˆí˜¸

| ê·œì¹™ | ì„¤ëª… |
| --- | --- |
| 1~15 ì‚¬ìš© | ìì£¼ ì“°ëŠ” í•„ë“œì— í• ë‹¹ (1 byte) |
| ë³€ê²½ ê¸ˆì§€ | í•œë²ˆ ì •í•˜ë©´ ë°”ê¾¸ì§€ ì•ŠìŒ |
| ì¬ì‚¬ìš© ê¸ˆì§€ | ì‚­ì œëœ ë²ˆí˜¸ëŠ” reserved ì²˜ë¦¬ |

### ìŠ¤í‚¤ë§ˆ ì§„í™”

| ì•ˆì „ | ìœ„í—˜ |
| --- | --- |
| í•„ë“œ ì¶”ê°€ | í•„ë“œ ë²ˆí˜¸ ë³€ê²½ |
| í•„ë“œ ì‚­ì œ (reserved) | í•„ë“œ íƒ€ì… ë³€ê²½ |
| í•„ë“œëª… ë³€ê²½ | ë²ˆí˜¸ ì¬ì‚¬ìš© |
